/* ========================================================================
 * bootstrap-tour - v0.9.3
 * http://bootstraptour.com
 * ========================================================================
 * Copyright 2012-2013 Ulrich Sossou
 *
 * ========================================================================
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================================
 */

!function(t,e){"use strict";var o,n;return n=function(){function o(e){null==e&&(e={}),this.options=t.extend(o.defaults,e),this.steps=[],this.force=!1,this.inited=!1,this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:!1,overlayElementShown:!1}}return o.prototype.addSteps=function(t){var e,o,n;for(o=0,n=t.length;n>o;o++)e=t[o],this.addStep(e);return this},o.prototype.addStep=function(t){return this.steps.push(new TourStep(t)),this},o.prototype.step=function(t){return this.steps[t]?this.steps[t]:!1},o.prototype.currentStep=function(t){return"undefined"==typeof t?this.current:(this.current=t,this._setState("current_step",t))},o.prototype.init=function(t){var e;return this.force=t,e=this._getState("current_step"),this.current=null===e?e:parseInt(e,10),this.ended()?(this._debug("Tour ended, init prevented."),this):(this._keyboard(this.options.keyboard),this._mouse(),this._onResize(function(t){return function(){return t.showStep(t.current)}}(this)),this.current&&this.showStep(this.current),this.inited=!0,this)},o.prototype.start=function(t){return null==t&&(t=!1),this.inited||this.init(t),null===this.current&&this._onPromiseDone(this._promise(null!=this.options.onStart?this.options.onStart(this):void 0),this.showStep,0),this},o.prototype.next=function(){return this._onPromiseDone(this.hideStep(this.current),this._showNextStep)},o.prototype.prev=function(){return this._onPromiseDone(this.hideStep(this.current),this._showPrevStep)},o.prototype.goTo=function(t){return this._onPromiseDone(this.hideStep(this.current),this.showStep,t)},o.prototype.end=function(){return this._onPromiseDone(this.hideStep(this.current),function(o){return function(){return t(document).off("click.tour-"+o.options.name),t(document).off("keyup.tour-"+o.options.name),t(e).off("resize.tour-"+o.options.name),o._setState("end","yes"),o.inited=!1,o.force=!1,o._clearTimer(),null!=o.options.onEnd?o.options.onEnd(o):void 0}}(this))},o.prototype.ended=function(){return!this.force&&!!this._getState("end")},o.prototype.restart=function(){return this._removeState("current_step"),this._removeState("end"),this.start()},o.prototype.pause=function(){var t;return t=this.step(this.current),t&&t.duration?(this._paused=!0,this._duration-=(new Date).getTime()-this._start,e.clearTimeout(this._timer),this._debug("Paused/Stopped step "+(this.current+1)+" timer ("+this._duration+" remaining)."),null!=t.onPause?t.onPause(this,this._duration):void 0):this},o.prototype.resume=function(){var t;return t=this.step(this.current),t&&t.duration?(this._paused=!1,this._start=(new Date).getTime(),this._duration=this._duration||t.duration,this._timer=e.setTimeout(function(t){return function(){return t._isLast()?t.next():t.end()}}(this),this._duration),this._debug("Started step "+(this.current+1)+" timer with duration "+this._duration),null!=t.onResume&&this._duration!==t.duration?t.onResume(this,this._duration):void 0):this},o.prototype.hideStep=function(e){var o,n;return(n=this.step(e))?(this._clearTimer(),o=this._promise(null!=n.onHide?n.onHide(this,e):void 0),this._onPromiseDone(o,function(o){return function(){var r;return r=t(n.element),r.data("bs.popover")||r.data("popover")||(r=t("body")),r.popover("destroy").removeClass("tour-"+o.options.name+"-element tour-"+o.options.name+"-"+e+"-element"),n.reflex&&r.removeClass("tour-step-element-reflex").off(""+o._reflexEvent(n.reflex)+".tour-"+o.options.name),n.backdrop&&o._hideBackdrop(),null!=n.onHidden?n.onHidden(o):void 0}}(this)),o):void 0},o.prototype.showStep=function(t){var o,n,r,i;return this.ended()?(this._debug("Tour ended, showStep prevented."),this):(i=this.step(t))?(r=t<this.current,o=this._promise(null!=i.onShow?i.onShow(this,t):void 0),n=function(e){return function(){var o,n;if(e.currentStep(t),n=function(){switch({}.toString.call(i.path)){case"[object Function]":return i.path();case"[object String]":return this.options.basePath+i.path;default:return i.path}}.call(e),o=[document.location.pathname,document.location.hash].join(""),e._isRedirect(n,o))return void e._redirect(i,n);if(e._isOrphan(i)){if(!i.orphan)return e._debug("Skip the orphan step "+(e.current+1)+".\nOrphan option is false and the element does not exist or is hidden."),void(r?e._showPrevStep():e._showNextStep());e._debug("Show the orphan step "+(e.current+1)+". Orphans option is true.")}return i.backdrop&&e._showBackdrop(e._isOrphan(i)?void 0:i.element),e._scrollIntoView(i.element,function(){return e.currentStep()===t?(null!=i.element&&i.backdrop&&e._showOverlayElement(i),e._showPopover(i,t),null!=i.onShown&&i.onShown(e),e._debug("Step "+(e.current+1)+" of "+e.steps.length)):void 0}),i.duration?e.resume():void 0}}(this),i.delay?(this._debug("Wait "+i.delay+" milliseconds to show the step "+(this.current+1)),e.setTimeout(function(t){return function(){return t._onPromiseDone(o,n)}}(this),i.delay)):this._onPromiseDone(o,n),o):void 0},o.prototype._setState=function(t,e){var o,n;if(this.options.storage){n=""+this.options.name+"_"+t;try{this.options.storage.setItem(n,e)}catch(r){o=r,o.code===DOMException.QUOTA_EXCEEDED_ERR&&this.debug("LocalStorage quota exceeded. State storage failed.")}return this.options.afterSetState(n,e)}return null==this._state&&(this._state={}),this._state[t]=e},o.prototype._removeState=function(t){var e;return this.options.storage?(e=""+this.options.name+"_"+t,this.options.storage.removeItem(e),this.options.afterRemoveState(e)):null!=this._state?delete this._state[t]:void 0},o.prototype._getState=function(t){var e,o;return this.options.storage?(e=""+this.options.name+"_"+t,o=this.options.storage.getItem(e)):null!=this._state&&(o=this._state[t]),(void 0===o||"null"===o)&&(o=null),console.log(this.options),this.options.afterGetState(t,o),o},o.prototype._showNextStep=function(){var t;return t=this.step(this.current),this._onPromiseDone(this._promise(null!=t.onNext?t.onNext(this):void 0),function(t){return function(){return t.showStep(t.current+1)}}(this))},o.prototype._showPrevStep=function(){var t;return t=this.step(this.current),this._onPromiseDone(this._promise(null!=t.onPrev?t.onPrev(this):void 0),function(t){return function(){return t.showStep(t.current-1)}}(this))},o.prototype._debug=function(t){return this.options.debug?e.console.log("Bootstrap Tour '"+this.options.name+"' | "+t):void 0},o.prototype._isRedirect=function(t,e){return null!=t&&""!==t&&("[object RegExp]"==={}.toString.call(t)&&!t.test(e)||"[object String]"==={}.toString.call(t)&&t.replace(/\?.*$/,"").replace(/\/?$/,"")!==e.replace(/\/?$/,""))},o.prototype._redirect=function(e,o){return t.isFunction(e.redirect)?e.redirect.call(this,o):e.redirect===!0?(this._debug("Redirect to "+o),document.location.href=o):void 0},o.prototype._isOrphan=function(e){return null==e.element||!t(e.element).length||t(e.element).is(":hidden")&&"http://www.w3.org/2000/svg"!==t(e.element)[0].namespaceURI},o.prototype._isLast=function(){return this.current<this.steps.length-1},o.prototype._showPopover=function(e,o){var n,r,i,s;return t(".tour-"+this.options.name).remove(),s=t.extend({},this.options),i=this._isOrphan(e),e.template=this._template(e,o),i&&(e.element="body",e.placement="top"),n=t(e.element),n.addClass("tour-"+this.options.name+"-element tour-"+this.options.name+"-"+o+"-element"),e.options&&t.extend(s,e.options),e.reflex&&!i&&(n.addClass("tour-step-element-reflex"),n.off(""+this._reflexEvent(e.reflex)+".tour-"+this.options.name),n.on(""+this._reflexEvent(e.reflex)+".tour-"+this.options.name,function(t){return function(){return t._isLast()?t.next():t.end()}}(this))),n.popover({placement:e.placement,trigger:"manual",title:e.title,content:e.content,html:!0,animation:e.animation,container:e.container,template:e.template,selector:e.element}).popover("show"),r=n.data("bs.popover")?n.data("bs.popover").tip():n.data("popover").tip(),r.attr("id","tour-step-"+o+"-tooltip"),this._reposition(r,e),this._isOrphan(e)?this._center(r):void 0},o.prototype._template=function(e,o){var n,r,i,s;return s=t(t.isFunction(e.template)?e.template(o,e):e.template),n=s.find(".popover-navigation"),i=n.find('[data-role="prev"]'),r=n.find('[data-role="next"]'),this._isOrphan(e)&&s.addClass("orphan"),s.addClass("tour-"+this.options.name+" tour-"+this.options.name+"-"+o),0===o&&n.find('[data-role="prev"]').addClass("disabled"),o===this.steps.length-1&&n.find('[data-role="next"]').addClass("disabled"),e.duration||n.find('[data-role="pause-resume"]').remove(),s.clone().wrap("<div>").parent().html()},o.prototype._reflexEvent=function(t){return"[object Boolean]"==={}.toString.call(t)?"click":t},o.prototype._reposition=function(e,o){var n,r,i,s,u,a,p;if(s=e[0].offsetWidth,r=e[0].offsetHeight,p=e.offset(),u=p.left,a=p.top,n=t(document).outerHeight()-p.top-e.outerHeight(),0>n&&(p.top=p.top+n),i=t("html").outerWidth()-p.left-e.outerWidth(),0>i&&(p.left=p.left+i),p.top<0&&(p.top=0),p.left<0&&(p.left=0),e.offset(p),"bottom"===o.placement||"top"===o.placement){if(u!==p.left)return this._replaceArrow(e,2*(p.left-u),s,"left")}else if(a!==p.top)return this._replaceArrow(e,2*(p.top-a),r,"top")},o.prototype._center=function(o){return o.css("top",t(e).outerHeight()/2-o.outerHeight()/2)},o.prototype._replaceArrow=function(t,e,o,n){return t.find(".arrow").css(n,e?50*(1-e/o)+"%":"")},o.prototype._scrollIntoView=function(o,n){var r,i,s,u,a,p;return r=t(o),r.length?(i=t(e),u=r.offset().top,p=i.height(),a=Math.max(0,u-p/2),this._debug("Scroll into view. ScrollTop: "+a+". Element offset: "+u+". Window height: "+p+"."),s=0,t("body, html").stop(!0,!0).animate({scrollTop:Math.ceil(a)},function(t){return function(){return 2===++s?(n(),t._debug("Scroll into view.\nAnimation end element offset: "+r.offset().top+".\nWindow height: "+i.height()+".")):void 0}}(this))):n()},o.prototype._onResize=function(o,n){return t(e).on("resize.tour-"+this.options.name,function(){return clearTimeout(n),n=setTimeout(o,100)})},o.prototype._mouse=function(){var e;return e=this,t(document).off("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='prev']").off("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='next']").off("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='end']").off("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='pause-resume']").on("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='next']",function(t){return function(e){return e.preventDefault(),t.next()}}(this)).on("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='prev']",function(t){return function(e){return e.preventDefault(),t.prev()}}(this)).on("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='end']",function(t){return function(e){return e.preventDefault(),t.end()}}(this)).on("click.tour-"+this.options.name,".popover.tour-"+this.options.name+" *[data-role='pause-resume']",function(o){var n;return o.preventDefault(),n=t(this),n.text(n.data(e._paused?"pause-text":"resume-text")),e._paused?e.resume():e.pause()})},o.prototype._keyboard=function(){return"undefined"==typeof value?this.options.keyboard:t(document).off("keyup.tour-"+this.options.name).on("keyup.tour-"+this.options.name,function(t){return function(e){if(e.which)switch(e.which){case 39:return e.preventDefault(),t._isLast()?t.next():t.end();case 37:if(e.preventDefault(),t.current>0)return t.prev();break;case 27:return e.preventDefault(),t.end()}}}(this))},o.prototype._promise=function(e){return e&&t.isFunction(e.then)?e:null},o.prototype._onPromiseDone=function(t,e,o){return t?t.then(function(t){return function(){return e.call(t,o)}}(this)):e.call(this,o)},o.prototype._showBackdrop=function(){return this.backdrop.backgroundShown?void 0:(this.backdrop=t("<div>",{"class":"tour-backdrop"}),this.backdrop.backgroundShown=!0,t("body").append(this.backdrop))},o.prototype._hideBackdrop=function(){return this._hideOverlayElement(),this._hideBackground()},o.prototype._hideBackground=function(){return this.backdrop?(this.backdrop.remove(),this.backdrop.overlay=null,this.backdrop.backgroundShown=!1):void 0},o.prototype._showOverlayElement=function(e){var o,n;return o=t(e.element),o&&0!==o.length&&!this.backdrop.overlayElementShown?(this.backdrop.overlayElementShown=!0,this.backdrop.$element=o.addClass("tour-step-backdrop"),this.backdrop.$background=t("<div>",{"class":"tour-step-background"}),n={width:o.innerWidth(),height:o.innerHeight(),offset:o.offset()},this.backdrop.$background.appendTo("body"),e.backdropPadding&&(n=this._applyBackdropPadding(e.backdropPadding,n)),this.backdrop.$background.width(n.width).height(n.height).offset(n.offset)):void 0},o.prototype._hideOverlayElement=function(){return this.backdrop.overlayElementShown?(this.backdrop.$element.removeClass("tour-step-backdrop"),this.backdrop.$background.remove(),this.backdrop.$element=null,this.backdrop.$background=null,this.backdrop.overlayElementShown=!1):void 0},o.prototype._applyBackdropPadding=function(t,e){return"object"==typeof t?(null==t.top&&(t.top=0),null==t.right&&(t.right=0),null==t.bottom&&(t.bottom=0),null==t.left&&(t.left=0),e.offset.top=e.offset.top-t.top,e.offset.left=e.offset.left-t.left,e.width=e.width+t.left+t.right,e.height=e.height+t.top+t.bottom):(e.offset.top=e.offset.top-t,e.offset.left=e.offset.left-t,e.width=e.width+2*t,e.height=e.height+2*t),e},o.prototype._clearTimer=function(){return e.clearTimeout(this._timer),this._timer=null,this._duration=null},o}(),o=function(){function e(e){null==e&&(e={}),this.options=t.extend(TourStep.defaults,e)}return e}(),e.Tour=n,e.TourStep=o,e.Tour.defaults={name:"tour",basePath:"",storage:function(){var t;try{t=e.localStorage}catch(o){t=!1}return t}(),debug:!1,afterSetState:function(){},afterGetState:function(){},afterRemoveState:function(){},onStart:function(){},onEnd:function(){}},e.TourStep.defaults={path:"",placement:"right",title:"",content:"<p></p>",animation:!0,container:"body",keyboard:!0,backdrop:!1,backdropPadding:0,redirect:!0,orphan:!1,duration:!1,delay:!1,template:'<div class="popover" role="tooltip"> <div class="arrow"></div> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-default" data-role="prev">&laquo; Prev</button> <button class="btn btn-sm btn-default" data-role="next">Next &raquo;</button> <button class="btn btn-sm btn-default" data-role="pause-resume" data-pause-text="Pause" data-resume-text="Resume">Pause</button> </div> <button class="btn btn-sm btn-default" data-role="end">End tour</button> </div> </div>',onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNext:function(){},onPrev:function(){},onPause:function(){},onResume:function(){}}}(window.jQuery,window);